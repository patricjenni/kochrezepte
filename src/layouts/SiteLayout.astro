---
const { title } = Astro.props;
import "../styles/mystyles.scss";
import favicon from "../assets/favicon.ico";

const baseUrl = import.meta.env.BASE_URL;

// Ensure baseUrl always ends with / for proper concatenation
const joinUrl = (base: string, path: string) => {
  // If path is an absolute URL or protocol-relative, return it unchanged
  if (/^(?:[a-z][a-z0-9+.-]*:)?\/\//i.test(path)) return path;

  // Remove trailing slashes from base and leading slashes from path,
  // then join with a single slash.
  const normalizedBase = base.replace(/\/+$/, "");
  const normalizedPath = path.replace(/^\/+/, "");

  // If path is empty, return base (with a single trailing slash if base was root)
  if (normalizedPath === "")
    return normalizedBase === "" ? "/" : normalizedBase;

  return `${normalizedBase}/${normalizedPath}`;
};

const getNavUrl = (path: string): string => joinUrl(baseUrl, path);

const navItems = [
  { label: "Home", href: baseUrl },
  { label: "How-To", href: getNavUrl("how-to/") },
  { label: "Zahlen", href: getNavUrl("indicators/") },
  { label: "Kontakt", href: getNavUrl("contact_us/") },
];

const recipes = [
  {
    label: "Zürigeschnetzeltes",
    href: getNavUrl("rezepte/zuerigeschnetzeltes/"),
  },
  { label: "Kartoffelsalat", href: "#" },
];
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href={favicon} />
    <title>Kochrezepte für Entwickler</title>
  </head>
  <input
    type="checkbox"
    id="navbar-check"
    class="is-hidden-desktop"
    style="display:none;"
  />

  <nav
    class="navbar is-fixed-top"
    role="navigation"
    aria-label="main navigation"
  >
    <div class="navbar-brand">
      <a class="navbar-item" href={baseUrl}> </a>

      <label for="navbar-check" role="button" class="navbar-burger">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </label>
    </div>

    <div id="navbarBasicExample" class="navbar-menu">
      <div class="navbar-start">
        {
          navItems.map((item) => (
            <a class="navbar-item" href={item.href}>
              {item.label}
            </a>
          ))
        }

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link"> Rezepte </a>
          <div class="navbar-dropdown">
            {
              recipes.map((recipe) => (
                <a class="navbar-item" href={recipe.href}>
                  {recipe.label}
                </a>
              ))
            }
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href={getNavUrl("about/")}> About </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href={getNavUrl("about/#WhatWePractice")}>
              Was wir üben
            </a>
            <a class="navbar-item" href={getNavUrl("about/#TermsInProject")}>
              Begriffe im Projekt
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <section class="hero is-fullheight-with-navbar">
    <div class="hero-body">
      <div class="container mt-6">
        <p class="title has-text-centered">{title}</p>
        <slot />
      </div>
    </div>
  </section>


</html>
